<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIANA Robot Interface</title>
    <link rel="stylesheet" href="styles/interface.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>SIANA Robot Interface</h1>
            <div class="connection-status">
                <span id="wifi-status" class="connected"><i class="fa-solid fa-wifi"></i> Connecté</span>
            </div>
        </header>

        <div class="main-content">
            <!-- Left Panel: Pilotage and Servos -->
            <div class="left-panel">
                <div class="controls"> <!-- Pilotage Section -->
                    <h2>Pilotage</h2>
                    <div class="control-buttons">
                        <button id="forward" class="direction-btn"><i class="fa-solid fa-arrow-up"></i></button>
                        <div class="middle-row">
                            <button id="left" class="direction-btn"><i class="fa-solid fa-arrow-left"></i></button>
                            <button id="stop" class="direction-btn"><i class="fa-solid fa-stop"></i></button>
                            <button id="right" class="direction-btn"><i class="fa-solid fa-arrow-right"></i></button>
                        </div>
                        <button id="backward" class="direction-btn"><i class="fa-solid fa-arrow-down"></i></button>
                    </div>
                </div>

                <div class="controls"> <!-- Contrôle des servomoteurs Section -->
                    <h2>Contrôle des servomoteurs</h2>
                    <div class="servo-controls">
                        <div class="servo-container">
                            <h3>Moteur 0</h3>
                            <div class="servo-buttons">
                                <button id="servo0-left" class="servo-btn"><i class="fa-solid fa-rotate-left"></i></button>
                                <button id="servo0-right" class="servo-btn"><i class="fa-solid fa-rotate-right"></i></button>
                            </div>
                        </div>
                        <div class="servo-container">
                            <h3>Moteur 1</h3>
                            <div class="servo-buttons">
                                <button id="servo1-left" class="servo-btn"><i class="fa-solid fa-rotate-left"></i></button>
                                <button id="servo1-right" class="servo-btn"><i class="fa-solid fa-rotate-right"></i></button>
                            </div>
                        </div>
                        <div class="servo-container">
                            <h3>Moteur 2</h3>
                            <div class="servo-buttons">
                                <button id="servo2-left" class="servo-btn"><i class="fa-solid fa-rotate-left"></i></button>
                                <button id="servo2-right" class="servo-btn"><i class="fa-solid fa-rotate-right"></i></button>
                            </div>
                        </div>
                        <!-- NOUVEAU SERVO 3 AVEC SLIDER -->
                        <div class="servo-container servo-slider-container">
                            <h3>Moteur 3</h3>
                            <input type="range" id="servo3-slider" min="0" max="180" value="90" class="servo-range-slider">
                            <span id="servo3-value" class="servo-value-display">90°</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel: Camera and Other Status Panels -->
            <div class="right-panel">
                <div class="camera-feed"> <!-- Détection d'objets Section -->
                    <h2>Détection d'objets</h2>
                    <div class="camera-container">
                        <div class="detection-mode-selector">
                            <div class="mode-toggle">
                                <input type="radio" id="image-mode" name="detection-mode" value="image" checked>
                                <label for="image-mode">Image</label>
                                <input type="radio" id="realtime-mode" name="detection-mode" value="realtime">
                                <label for="realtime-mode">Temps réel</label>
                            </div>
                        </div>
                        
                        <div id="image-detection-container" class="detection-container">
                            <div class="image-upload-container">
                                <form id="image-upload-form" enctype="multipart/form-data">
                                    <div class="upload-area" id="upload-area">
                                        <i class="fa-solid fa-cloud-arrow-up"></i>
                                        <p>Glissez une image ou cliquez pour choisir</p>
                                        <input type="file" id="image-input" accept="image/*" hidden>
                                    </div>
                                    <button type="submit" id="process-image-btn" disabled>Analyser l'image</button>
                                </form>
                                <div class="result-container" id="image-result-container" style="display: none;">
                                    <img id="result-image" src="" alt="Résultat de l'analyse">
                                    <button id="new-image-btn">Nouvelle image</button>
                                </div>
                            </div>
                        </div>
                        
                        <div id="realtime-detection-container" class="detection-container" style="display: none;">
                            <div id="realtime-view-wrapper"> 
                                <div class="stream-container">
                                    <img id="camera-stream" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Camera Stream">
                                    <div id="stream-status" class="stream-status disconnected">Flux vidéo déconnecté</div>
                                    <div id="detection-status" class="detection-status inactive">Détection inactive</div>
                                </div>
                                
                                <div id="detection-result-container" class="result-container" style="display: none;">
                                    <img id="detection-result" src="" alt="Résultat de la détection">
                                </div>
                            </div>

                            <div class="detection-controls">
                                <button id="toggle-detection-btn">Activer la détection</button> 
                            </div>
                                                        
                            <div id="detection-loading-container" class="loading-container" style="display: none;">
                                <div class="loading-spinner"></div>
                                <p>Initialisation de la détection en temps réel...</p>
                            </div>
                        </div>
                        
                        <div class="luminosity">
                            <i class="fa-solid fa-sun"></i> Luminosité: <span id="luminosity-value">85%</span>
                        </div>
                    </div>
                </div>

                <!-- BOUTON MODE AUTONOME DÉPLACÉ ICI -->
                <div class="autonomous-mode-container">
                    <button id="autonomous-mode-btn" class="action-btn info"><i class="fa-solid fa-robot"></i> Mode Autonome</button>
                </div>

                <div class="defects-panel">
                    <h2>Défauts</h2>
                    <ul id="defects-list">
                        <li class="defect warning"><i class="fa-solid fa-exclamation-triangle"></i> Batterie faible (25%)</li>
                        <li class="defect critical"><i class="fa-solid fa-times-circle"></i> Capteur ultrason avant défaillant</li>
                        <li class="defect warning"><i class="fa-solid fa-exclamation-triangle"></i> Connexion Wi-Fi instable</li>
                    </ul>
                </div>

                <!-- SECTIONS events-panel, status-panel, maintenance-panel ONT ÉTÉ SUPPRIMÉES -->

            </div>
        </div>

        <div class="history-panel">
            <h2>Historique des opérations</h2>
            <div class="history-container">
                <table id="operations-history">
                    <thead>
                        <tr>
                            <th>Heure</th>
                            <th>Événement</th>
                            <th>Détails</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>14:32:15</td>
                            <td>Démarrage</td>
                            <td>Robot initialisé avec succès</td>
                        </tr>
                        <tr>
                            <td>14:35:22</td>
                            <td>Inspection</td>
                            <td>Début d'inspection de la rame TGV #4587</td>
                        </tr>
                        <tr>
                            <td>14:42:18</td>
                            <td>Alerte</td>
                            <td>Détection d'anomalie à la position 87m</td>
                        </tr>
                        <tr>
                            <td>14:45:03</td>
                            <td>Changement vitesse</td>
                            <td>Vitesse modifiée de 10 à 5</td>
                        </tr>
                        <tr>
                            <td>14:47:56</td>
                            <td>Défaut</td>
                            <td>Capteur ultrason avant défaillant</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="scripts/interface.js"></script>
</body>
</html>